language: node_js
node_js:
- '6'
os:
- osx
env:
  matrix:
  - TARGET_ARCH=x64
osx_image: xcode7.3
addons:
  apt:
    packages:
    - xvfb
before_install:
- export DISPLAY=:99.0
- Xvfb :99 -screen 0 1440x900x24 > /dev/null 2>&1 &
cache:
  directories:
  - node_modules
install:
- nvm install 6
- npm install
- npm prune
- npm install -g bower
- bower install --allow-root
- bower prune
script:
- npm test
#branches:
#  only:
#  - master
#  - develop
#  - release
before_deploy:
  - npm run dist-unsigned
deploy:
  provider: releases
  skip_cleanup: true
  overwrite: true
  api-key:
    secure: UCvg/CXMPbtErJF7ev2tolNHLXGE/eIAR9hVBw7TnCufbIJinl0UUgu/oC7CPVgnqHUCC/VElTt849vh4eGsHPq5g5jMBk47bRLJtawVveOIeJs9kqKShvrKEai+valSAt/iHXvutBhIH9K/A1f+VNt+35OCJi3dtxwFE0XzciqIbAMNxcPiDtSsxP7sYCZEFRNBEQBuHL8boVMjDylvNPtIaijOrojBFSU8nDLp7XuaJdXbTGjsdGrtWqJvUfk8yoPzaMeRk17NhRK/bJfQD/Jh0sdWKnOQfQ0R/fRi4cDE7qkbUXE5p9li6CaxXmCa9m1Sb1fssA5DHZA2woEzk953XsVN4SF8b0vAdQft66ipD0cm6UuZ/dVdaZ0S0QC4ltRCswrZhgBrKVHmsWs4uYO7TVp5fa93BUjybrWOGvkJCYW29gtu3R0K/6oNt9zwdCjsgeAcRz7WfVRspdigQghNVXMCVeJukd0lz3n+pAObdDbiLk78TM9hz0D0cWEWIfCeetbXpdRFv2pDmj3YPgs3cbdBmm+F3Yby7Mnl03Ao8xfFqPZpMch2brogUBYQ7+g8dQU7uMqAXikE5bm6qSKzjvTnEu02peYu02dxoAV1rl91502VR/VVizot6TVClDnEZjgEvPltQ87kHVu8Z3T4JSpqOx3cLxPwnFWX//w=
  on:
    tags: true
  all_branches: true
  file_glob: true
  file: dist/mac/BrowserDispatcher-*
